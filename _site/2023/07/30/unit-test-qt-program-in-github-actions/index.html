<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YJYVP3SE0S"></script>
<script>
  var host = window.location.hostname;
  if (host != "127.0.0.1" && host != "localhost")
  {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-YJYVP3SE0S');
  }
</script>


  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta charset="UTF-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Perform unit testing of Qt programs in GitHub Actions using Docker &middot; Mojtaba Barzegari
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <!-- <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface"> -->
  <link rel="stylesheet" href="/public/css/font.css">
  <link rel="stylesheet" href="/public/css/social.css">

  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- Mathjax Support -->
  <script type="text/javascript" async
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
</head>


  <body class="theme-base-0d">

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>Mojtaba Barzegari</h1>
      <p class="lead"></p>
    </div>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
        <a href="/">Home</a>
      </li>

      

      
      
        
          
        
      
        
          
            
              <li class="sidebar-nav-item">
                <a href="/about/">About Me</a>
              </li>
            
          
        
      
        
      
        
          
            
              <li class="sidebar-nav-item">
                <a href="/blog/">Blog</a>
              </li>
            
          
        
      
        
          
            
              <li class="sidebar-nav-item">
                <a href="/contact/">Contact</a>
              </li>
            
          
        
      
        
          
        
      
        
          
            
          
        
      
        
          
            
              <li class="sidebar-nav-item">
                <a href="/presentations/">Presentations & Posters</a>
              </li>
            
          
        
      
        
          
            
              <li class="sidebar-nav-item">
                <a href="/projects/">GitHub Projects</a>
              </li>
            
          
        
      
        
          
            
              <li class="sidebar-nav-item">
                <a href="/publications/">Publications</a>
              </li>
            
          
        
      
        
          
            
              <li class="sidebar-nav-item">
                <a href="/research/">Research Portfolio</a>
              </li>
            
          
        
      
        
          
            
              <li class="sidebar-nav-item">
                <a href="/usefulbooks/">Useful Books and Links</a>
              </li>
            
          
        
      
        
          
            
              <li class="sidebar-nav-item">
                <a href="/videos/">Videos</a>
              </li>
            
          
        
      
        
          
            
              <li class="sidebar-nav-item">
                <a href="/whatiuse/">What I Use</a>
              </li>
            
          
        
      

      <li class="sidebar-nav-item"><a href="https://mbarzegary.github.io/research-tech-radar/">Research Technology Radar</a></li>
      <li class="sidebar-nav-item"><a href="http://nbviewer.jupyter.org/github/mbarzegary/MyCV-shortened/blob/main/main.pdf">CV</a></li>
      
      <ul style="margin-left: -15px" class="icon-effect icon-effect-1a">
        <li><a target="_blank" href="https://github.com/mbarzegary" class="icon"><i class="fab fa-github"></i></a></li>
        <li><a target="_blank" href="https://www.linkedin.com/in/mbarzegary/" class="icon"><i class="fab fa-linkedin-in"></i></a></li>
        <li><a target="_blank" href="https://twitter.com/MojBarz" class="icon"><i class="fab fa-twitter"></i></a></li>
        <!-- <li><a target="_blank" href="https://www.instagram.com/mbarzegary/" class="icon"><i class="fab fa-instagram"></i></a></li> -->
        <li><a target="_blank" href="https://www.youtube.com/TuxRiders" class="icon"><i class="fab fa-youtube"></i></a></li>
        <li><a target="_blank" href="https://www.facebook.com/mbarzegary" class="icon"><i class="fab fa-facebook-f"></i></a></li>
      </ul>


      <!-- <li class="sidebar-nav-item"><a href="https://github.com/mbarzegary/mbarzegary.github.io/archive/v.zip">Download</a></li>
      <li class="sidebar-nav-item"><a href="https://github.com/mbarzegary/mbarzegary.github.io">GitHub project</a></li>
      <li class="sidebar-nav-item">Currently v</li> -->
    </ul>

    <p>Copyleft 2023. No right reserved.</p>
  </div>
</div>


    <div class="content container">
      <div class="post">
  <h1 class="post-title">Perform unit testing of Qt programs in GitHub Actions using Docker</h1>
  <span class="post-date">30 Jul 2023</span>
  <p>In the <a href="/2022/12/09/build-qt-in-docker-for-github-actions/">previous post</a>, we built a Docker container for Qt and pushed it to <a href="https://hub.docker.com/r/mbarzegary/qt-5.15.2-freefem-4.10">Docker Hub</a> (the pushed container includes FreeFEM too, but we don’t need to care about it for the purpose of this post). Now, it’s time to pull the image in a GitHub Action to test the build process and functionality of Qt programs.</p>

<p>We use <a href="https://github.com/addnab/docker-run-action">this action</a> to pull the image and run the build procedure. First, we add a YAML file, called <code class="highlighter-rouge">main.yml</code>, to the directory <code class="highlighter-rouge">.github/workflows</code> in the GitHub repository (like <a href="https://github.com/mbarzegary/BioDeg-UI/blob/main/.github/workflows/main.yml">this example</a>) and add the following content to it:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># This is a basic workflow to help you get started with Actions</span>

<span class="na">name</span><span class="pi">:</span> <span class="s">build</span>

<span class="c1"># Controls when the workflow will run</span>
<span class="na">on</span><span class="pi">:</span>
  <span class="c1"># Triggers the workflow on push or pull request events but only </span>
  <span class="c1"># for the main branch</span>
  <span class="na">push</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span> <span class="pi">[</span> <span class="nv">main</span> <span class="pi">]</span>
  <span class="na">pull_request</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span> <span class="pi">[</span> <span class="nv">main</span> <span class="pi">]</span>

  <span class="c1"># Allows you to run this workflow manually from the Actions tab</span>
  <span class="na">workflow_dispatch</span><span class="pi">:</span>

<span class="c1"># A workflow run is made up of one or more jobs that can run</span>
<span class="c1"># sequentially or in parallel</span>
<span class="na">jobs</span><span class="pi">:</span>
  <span class="c1"># This workflow contains a single job called "build"</span>
  <span class="na">build</span><span class="pi">:</span>
    <span class="c1"># The type of runner that the job will run on</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>

    <span class="c1"># Steps represent a sequence of tasks that will be executed </span>
    <span class="c1"># as part of the job</span>
    <span class="na">steps</span><span class="pi">:</span>
      <span class="c1"># Checks-out your repository under $GITHUB_WORKSPACE, </span>
      <span class="c1"># so your job can access it</span>
      <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v2</span>

      <span class="c1"># Pulls a Docker image and builds the software inside it</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Build and test BioDeg</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">addnab/docker-run-action@v3</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">registry</span><span class="pi">:</span> <span class="s">docker.io</span>
          <span class="na">image</span><span class="pi">:</span> <span class="s">mbarzegary/qt-5.15.2-freefem-4.10:latest</span>
          <span class="na">options</span><span class="pi">:</span> <span class="s">-v $:/data</span> 
          <span class="na">run</span><span class="pi">:</span> <span class="s">/data/buildWithDocker.sh</span>
</code></pre></div></div>

<p>This action gets triggered when any commit is pushed to the repository, resulting in the Docker image being pulled and the whole repository being mounted into a directory called <code class="highlighter-rouge">data</code>. Then, it executes the build script file (in this case, <code class="highlighter-rouge">buildWithDocker.sh</code> in the root of the repository) inside the container. The following is an example of the <code class="highlighter-rouge">buildWithDocker.sh</code> file:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c"># build the repo inside the docker container</span>
<span class="c"># used for CI builds and tests</span>
<span class="nb">cd</span> /data
<span class="nb">mkdir </span>build
<span class="nb">cd </span>build
cmake ..
make
make <span class="nb">test</span>
</code></pre></div></div>

<p>The full running example can be explored in <a href="https://github.com/mbarzegary/BioDeg-UI">this repository</a>. The log of previous ran tests can be viewed <a href="https://github.com/mbarzegary/BioDeg-UI/actions/workflows/main.yml">here</a>.</p>

</div>

<!-- <div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2022/12/09/build-qt-in-docker-for-github-actions/">
            Build Qt inside a Docker container for GitHub Actions
            <small>09 Dec 2022</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2022/11/14/derive-weak-form-pde-navier-stokes/">
            Weak (variational) formulation of Navier-Stokes equation
            <small>14 Nov 2022</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2022/10/27/high-performance-computing-scaling-challenge/">
            High-performance computing&#58; challenges of performance tuning and scaling of finite element models
            <small>27 Oct 2022</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div> -->

    </div>

  </body>
</html>
